import React, { useEffect, useRef } from 'react';
import rough from 'roughjs';

const SketchTitleText = ({ 
  width = 400, 
  height = 150, 
  fps = 10,
  strokeWidth = 2
}) => {
  const canvasRef = useRef(null);   
  const requestRef = useRef();
  const timeRef = useRef(0);
  const fpsInterval = 1000 / fps;

  // Replace this string with the actual 'd' attribute from your sketch_title.svg path
  const SVG_PATH = "M 65.496 73.338 Q 64.059 74.596 62.486 72.17 Q 60.914 69.744 59.297 64.848 Q 57.68 59.951 56.108 53.123 Q 54.535 46.295 53.098 38.658 Q 51.66 31.022 50.358 23.16 Q 49.055 15.299 48.067 8.381 Q 48.067 7.123 48.022 5.821 Q 47.977 4.518 48.291 3.395 Q 48.606 2.272 49.459 1.373 Q 50.313 0.475 52.11 0.026 Q 52.289 -0.064 52.873 0.16 Q 53.457 0.385 54.086 0.699 Q 54.715 1.014 55.209 1.373 Q 55.703 1.733 55.883 2.002 Q 54.715 18.803 59.746 34.705 Q 60.016 34.436 61.184 32.864 Q 62.352 31.291 64.149 29.18 Q 65.945 27.069 68.236 24.643 Q 70.527 22.217 73.043 20.151 Q 75.559 18.084 78.074 16.692 Q 80.59 15.299 82.926 15.299 Q 84.274 15.299 85.576 15.928 Q 86.879 16.557 86.879 18.354 Q 86.879 18.533 86.789 18.848 Q 86.699 19.162 86.699 19.342 Q 85.262 20.6 82.342 23.205 Q 79.422 25.811 76.188 29.045 Q 72.953 32.28 69.988 35.783 Q 67.024 39.287 65.496 42.432 Q 65.227 42.971 65.317 43.375 Q 65.406 43.78 65.496 44.319 Q 66.485 44.678 68.641 45.397 Q 70.797 46.116 73.402 47.059 Q 76.008 48.002 78.973 49.035 Q 81.938 50.069 84.543 51.057 Q 87.149 52.045 89.26 52.809 Q 91.371 53.573 92.449 53.932 Q 93.707 54.471 94.516 54.651 Q 95.324 54.83 95.774 55.145 Q 96.223 55.459 96.402 55.998 Q 96.582 56.537 96.582 57.616 Q 96.582 60.221 95.324 61.03 Q 94.067 61.838 91.731 61.838 Q 84.813 61.389 78.164 58.918 Q 71.516 56.448 64.688 52.944 Q 64.418 54.651 64.912 56.897 Q 65.406 59.143 66.125 61.389 Q 66.844 63.635 67.518 65.791 Q 68.192 67.948 68.326 69.655 Q 68.461 71.362 67.922 72.35 Q 67.383 73.338 65.496 73.338 Z M 253 16.737 Q 253 15.748 253.225 14.266 Q 253.449 12.783 254.033 11.436 Q 254.617 10.088 255.516 9.145 Q 256.414 8.201 257.852 8.201 Q 257.942 8.201 258.301 8.291 Q 258.66 8.381 258.75 8.381 Q 260.277 13.951 260.547 19.432 Q 260.817 24.912 260.367 30.078 Q 259.918 35.244 259.02 40.051 Q 258.121 44.858 257.537 48.901 Q 256.953 52.944 256.818 56.178 Q 256.684 59.412 257.762 61.658 Q 257.582 60.221 257.537 58.199 Q 257.492 56.178 257.897 54.022 Q 258.301 51.866 259.244 49.709 Q 260.188 47.553 261.985 45.846 Q 263.781 44.139 266.611 43.151 Q 269.442 42.162 273.664 42.162 Q 278.067 42.162 281.256 43.69 Q 284.445 45.217 286.512 47.867 Q 288.578 50.518 289.611 54.067 Q 290.645 57.616 290.645 61.658 Q 290.645 63.545 290.6 65.926 Q 290.555 68.307 289.971 70.328 Q 289.387 72.35 287.904 73.742 Q 286.422 75.135 283.547 75.135 Q 283.547 73.698 283.727 71.227 Q 283.906 68.756 283.951 65.971 Q 283.996 63.186 283.772 60.311 Q 283.547 57.436 282.559 55.145 Q 281.57 52.854 279.818 51.371 Q 278.067 49.889 275.012 49.889 Q 273.934 49.889 272.361 50.024 Q 270.789 50.158 269.172 50.877 Q 267.555 51.596 266.027 53.078 Q 264.5 54.561 263.602 57.121 Q 262.703 59.682 262.568 63.59 Q 262.434 67.498 263.512 73.158 Q 262.883 74.776 261.94 75.045 Q 260.996 75.315 259.559 75.315 Q 256.684 75.315 254.842 73.293 Q 253 71.272 252.012 67.858 Q 251.024 64.444 250.709 59.951 Q 250.395 55.459 250.485 50.563 Q 250.574 45.666 250.979 40.59 Q 251.383 35.514 251.787 30.977 Q 252.192 26.44 252.596 22.711 Q 253 18.983 253 16.737 Z M 26.055 5.866 Q 23.539 5.866 20.574 6.629 Q 17.61 7.393 14.69 8.741 Q 11.77 10.088 9.119 12.065 Q 6.469 14.041 4.447 16.422 Q 2.426 18.803 1.213 21.453 Q 0 24.104 0 27.069 Q 0 30.662 1.483 33.088 Q 2.965 35.514 5.436 37.221 Q 7.906 38.928 11.051 40.051 Q 14.195 41.174 17.475 42.117 Q 20.754 43.061 23.899 43.959 Q 27.043 44.858 29.514 46.205 Q 31.985 47.553 33.467 49.44 Q 34.949 51.326 34.949 54.201 Q 34.949 56.448 33.512 58.02 Q 32.074 59.592 29.873 60.76 Q 27.672 61.928 25.067 62.961 Q 22.461 63.994 20.08 65.162 Q 17.699 66.33 15.858 67.723 Q 14.016 69.116 13.567 71.272 Q 13.117 72.53 13.432 73.338 Q 13.746 74.147 14.33 74.551 Q 14.914 74.955 15.723 75.135 Q 16.531 75.315 17.25 75.315 Q 19.496 75.315 22.371 74.282 Q 25.246 73.248 28.256 71.586 Q 31.266 69.924 34.141 67.678 Q 37.016 65.432 39.307 62.961 Q 41.598 60.491 42.99 57.93 Q 44.383 55.369 44.383 53.033 Q 44.383 48.721 41.688 46.16 Q 38.992 43.6 34.949 42.028 Q 30.906 40.455 26.1 39.332 Q 21.293 38.209 17.25 36.772 Q 13.207 35.334 10.512 33.133 Q 7.817 30.932 7.817 27.069 Q 7.817 24.373 9.344 22.262 Q 10.871 20.151 13.297 18.533 Q 15.723 16.916 18.777 15.703 Q 21.832 14.491 24.797 13.682 Q 27.762 12.873 30.457 12.379 Q 33.152 11.885 34.86 11.705 L 34.86 9.639 Q 34.86 9.549 33.961 9.055 Q 33.063 8.561 31.805 7.977 Q 30.547 7.393 29.199 6.764 Q 27.852 6.135 27.043 5.866 L 26.055 5.866 Z M 150.399 27.069 Q 150.219 27.069 149.5 27.787 Q 148.781 28.506 148.422 28.955 Q 148.332 29.225 148.332 29.405 Q 148.242 29.584 148.242 29.854 Q 148.242 30.213 148.332 30.393 Q 148.332 30.662 148.422 30.842 Q 148.602 31.201 149.32 31.965 Q 150.039 32.729 150.399 32.729 L 167.738 36.682 Q 170.524 37.311 171.781 40.141 Q 173.039 42.971 173.623 46.969 Q 174.207 50.967 174.477 55.549 Q 174.746 60.131 175.555 64.219 Q 176.363 68.307 178.026 71.272 Q 179.688 74.237 183.102 75.135 Q 184.449 75.584 185.213 75.27 Q 185.977 74.955 186.381 74.371 Q 186.785 73.787 186.92 73.024 Q 187.055 72.26 187.055 71.541 Q 187.055 67.588 185.797 63.905 Q 184.539 60.221 183.057 56.537 Q 181.574 52.854 180.317 49.125 Q 179.059 45.397 179.059 41.444 Q 179.059 41.084 179.149 40.006 Q 179.238 38.928 179.238 38.479 Q 180.047 38.479 181.754 38.434 Q 183.461 38.389 185.527 38.209 Q 187.594 38.03 189.93 37.805 Q 192.266 37.58 194.332 37.401 Q 196.399 37.221 198.061 36.996 Q 199.723 36.772 200.442 36.682 Q 202.867 36.233 203.721 35.424 Q 204.574 34.616 204.574 32.729 Q 204.574 30.213 203.317 29.539 Q 202.059 28.866 199.947 29.135 Q 197.836 29.405 195.141 30.123 Q 192.445 30.842 189.615 30.977 Q 186.785 31.112 184.09 30.213 Q 181.395 29.315 179.283 26.35 Q 177.172 23.385 175.914 17.905 Q 174.656 12.424 174.656 3.35 Q 171.961 3.35 170.479 4.832 Q 168.996 6.315 168.322 8.606 Q 167.649 10.897 167.559 13.727 Q 167.469 16.557 167.693 19.162 Q 167.918 21.768 168.188 23.924 Q 168.457 26.08 168.457 27.069 L 150.399 27.069 Z M 100.086 50.158 Q 100.086 45.307 101.254 40.455 Q 102.422 35.604 104.983 31.741 Q 107.543 27.877 111.631 25.451 Q 115.719 23.026 121.559 23.026 Q 124.883 23.026 127.399 24.239 Q 129.914 25.451 131.621 27.428 Q 133.328 29.405 134.182 32.055 Q 135.035 34.705 135.035 37.58 Q 135.035 42.162 132.924 46.475 Q 130.813 50.787 127.264 54.067 Q 123.715 57.346 119.133 59.008 Q 114.551 60.67 109.789 59.772 Q 109.879 62.377 111.541 63.949 Q 113.203 65.522 115.539 66.33 Q 117.875 67.139 120.391 67.364 Q 122.906 67.588 124.883 67.588 Q 126.949 67.588 128.746 67.229 Q 130.543 66.869 132.34 66.42 Q 134.137 65.971 135.979 65.612 Q 137.82 65.252 139.887 65.252 Q 140.695 65.252 141.504 65.342 Q 142.313 65.432 143.031 65.746 Q 143.75 66.061 144.199 66.735 Q 144.649 67.408 144.649 68.397 Q 144.649 70.104 143.391 71.227 Q 142.133 72.35 140.201 73.158 Q 138.27 73.967 135.934 74.371 Q 133.598 74.776 131.397 75 Q 129.195 75.225 127.354 75.27 Q 125.512 75.315 124.613 75.315 Q 118.863 75.315 114.281 73.473 Q 109.699 71.631 106.555 68.352 Q 103.41 65.073 101.748 60.446 Q 100.086 55.819 100.086 50.158 Z M 109.61 44.319 Q 109.61 47.463 110.463 48.901 Q 111.317 50.338 114.641 50.338 Q 116.977 50.338 119.223 49.485 Q 121.469 48.631 123.311 47.104 Q 125.152 45.576 126.231 43.51 Q 127.309 41.444 127.309 39.018 Q 127.309 37.67 127.084 36.233 Q 126.86 34.795 126.141 33.582 Q 125.422 32.369 124.299 31.606 Q 123.176 30.842 121.379 30.842 Q 118.684 30.842 116.483 32.055 Q 114.281 33.268 112.754 35.199 Q 111.227 37.131 110.418 39.512 Q 109.61 41.893 109.61 44.319 Z M 206.192 48.092 Q 206.192 44.319 207.854 40.186 Q 209.516 36.053 212.301 32.684 Q 215.086 29.315 218.725 27.069 Q 222.363 24.823 226.406 24.823 Q 228.473 24.823 230.539 25.541 Q 232.606 26.26 234.268 27.608 Q 235.93 28.955 236.963 30.842 Q 237.996 32.729 237.996 35.065 Q 236.379 35.065 235.076 34.705 Q 233.774 34.346 232.516 33.852 Q 231.258 33.358 230.045 32.998 Q 228.832 32.639 227.395 32.639 Q 223.711 32.639 221.42 34.481 Q 219.129 36.323 217.781 39.108 Q 216.434 41.893 215.94 45.082 Q 215.445 48.272 215.445 51.057 Q 215.445 51.506 215.49 52.764 Q 215.535 54.022 215.58 55.414 Q 215.625 56.807 215.67 58.065 Q 215.715 59.323 215.805 59.772 Q 216.793 61.928 217.736 63.096 Q 218.68 64.264 219.758 64.848 Q 220.836 65.432 222.094 65.567 Q 223.352 65.701 225.059 65.701 Q 227.395 65.701 229.147 64.983 Q 230.899 64.264 232.426 63.276 Q 233.953 62.287 235.301 61.074 Q 236.649 59.862 238.131 58.828 Q 239.613 57.795 241.365 57.121 Q 243.117 56.448 245.363 56.448 Q 245.363 60.85 243.791 64.264 Q 242.219 67.678 239.389 70.104 Q 236.559 72.53 232.74 73.832 Q 228.922 75.135 224.43 75.135 Q 220.207 75.135 216.838 72.26 Q 213.469 69.385 211.088 65.207 Q 208.707 61.03 207.449 56.358 Q 206.192 51.686 206.192 48.092 Z M 294.418 7.662 Q 296.844 5.416 298.192 6.674 Q 299.539 7.932 300.213 11.436 Q 300.887 14.94 300.977 19.836 Q 301.067 24.733 301.111 29.854 Q 301.156 34.975 301.291 39.557 Q 301.426 44.139 302.055 46.834 Q 302.055 48.182 301.875 49.17 Q 301.695 50.158 301.246 50.787 Q 300.797 51.416 299.809 51.731 Q 298.82 52.045 297.203 52.045 Q 296.934 52.045 296.664 51.776 Q 296.395 51.506 296.125 50.203 Q 295.856 48.901 295.586 46.16 Q 295.317 43.42 295.092 38.479 Q 294.867 33.537 294.643 26.08 Q 294.418 18.623 294.418 7.662 Z M 301.156 67.319 Q 302.324 67.319 303.447 68.037 Q 304.57 68.756 304.885 69.789 Q 305.199 70.823 304.301 72.08 Q 303.402 73.338 300.438 74.416 Q 298.012 74.057 296.979 73.203 Q 295.945 72.35 295.811 71.407 Q 295.676 70.463 296.26 69.52 Q 296.844 68.576 297.697 67.903 Q 298.551 67.229 299.539 67.004 Q 300.527 66.78 301.156 67.319 Z"
  useEffect(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;

    const rc = rough.canvas(canvas);
    const ctx = canvas.getContext('2d');
    let lastDrawTime = performance.now();

    const animate = (currentTime) => {
      requestRef.current = requestAnimationFrame(animate);
      const elapsed = currentTime - lastDrawTime;

      if (elapsed > fpsInterval) {
        lastDrawTime = currentTime - (elapsed % fpsInterval);
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Drawing the SVG path with RoughJS for the "jitter" effect
        rc.path(SVG_PATH, {
          stroke: '#000',
          strokeWidth: strokeWidth,
          roughness: 1 + Math.sin(timeRef.current) * 0.3, // Animates the shakiness
          bowing: 2,
          fill: 'black',
          fillStyle : 'hachure'
        });

        timeRef.current += 0.1;
      }
    };

    requestRef.current = requestAnimationFrame(animate);
    return () => cancelAnimationFrame(requestRef.current);
  }, [fpsInterval, strokeWidth]);

  return (
    <canvas 
      ref={canvasRef} 
      width={width} 
      height={height} 
      className="max-w-full h-auto block" 
    />
  );
};

export default SketchTitleText;
